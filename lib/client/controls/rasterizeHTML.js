/*! rasterizeHTML.js - v0.8.0 - 2014-03-01
* http://www.github.com/cburgmer/rasterizeHTML.js
* Copyright (c) 2014 Christoph Burgmer; Licensed MIT */
/* Integrated dependencies:
 * url (MIT License),
 * CSSOM.js (MIT License),
 * ayepromise (BSD License & WTFPL),
 * xmlserializer (MIT License) */
var exports = false;
!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.rasterizeHTML=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};a[g][0].call(j.exports,function(b){var c=a[g][1][b];return e(c?c:b)},j,j.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){!function(e,f){"object"==typeof d?c.exports=f(b("url"),b("xmlserializer"),b("cssom"),b("ayepromise")):"function"==typeof a&&a.amd?a(["url","xmlserializer","cssom","ayepromise"],f):e.rasterizeHTML=f(e.url,e.xmlserializer,e.cssom,e.ayepromise)}(this,function(a,b,c,d){var e=function(a,b,c){"use strict";var d={};d.getDocumentBaseUrl=function(a){return"about:blank"!==a.baseURI?a.baseURI:null},d.clone=function(a){var b,c={};for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);return c},d.cloneArray=function(a){return Array.prototype.slice.apply(a,[0])},d.joinUrl=function(a,b){return c.resolve(a,b)},d.isDataUri=function(a){return/^data:/.test(a)},d.all=function(a){var c=b.defer(),d=a.length,e=[];return 0===a.length?(c.resolve([]),c.promise):(a.forEach(function(a,b){a.then(function(a){d-=1,e[b]=a,0===d&&c.resolve(e)},function(a){c.reject(a)})}),c.promise)},d.collectAndReportErrors=function(a){var b=[];return d.all(a.map(function(a){return a.fail(function(a){b.push(a)})})).then(function(){return b})};var e=null,f=function(a,b){return b===!1||"none"===b||"repeated"===b?((null===e||"repeated"!==b)&&(e=Date.now()),a+"?_="+e):a};d.ajax=function(c,e){var g,h=new a.XMLHttpRequest,i=b.defer(),j=d.joinUrl(e.baseUrl,c),k=function(){i.reject({msg:"Unable to load url",url:j})};g=f(j,e.cache),h.addEventListener("load",function(){200===h.status||0===h.status?i.resolve(h.response):k()},!1),h.addEventListener("error",k,!1);try{h.open("GET",g,!0),h.overrideMimeType(e.mimeType),h.send(null)}catch(l){k()}return i.promise},d.binaryAjax=function(a,b){var c=d.clone(b);return c.mimeType="text/plain; charset=x-user-defined",d.ajax(a,c).then(function(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(255&a.charCodeAt(c));return b})};var g=function(a){var b=function(a,b){return a.substring(0,b.length)===b};return b(a,"<?xml")||b(a,"<svg")?"image/svg+xml":"image/png"};d.getDataURIForImageURL=function(a,b){return d.binaryAjax(a,b).then(function(a){var b=btoa(a),c=g(a);return"data:"+c+";base64,"+b})};var h=[],i=function(a){return h.indexOf(a)<0&&h.push(a),h.indexOf(a)};return d.memoize=function(a,b,c){if("object"!=typeof c)throw new Error("cacheBucket is not an object");return function(){var d,e=Array.prototype.slice.call(arguments),f=b(e),g=i(a);return c[g]&&c[g][f]?c[g][f]:(d=a.apply(null,e),c[g]=c[g]||{},c[g][f]=d,d)}},d}(window,d,a),f=function(a,b,c,d){"use strict";var e={},f=function(a,b,c){a.style.setProperty(b,c,a.style.getPropertyPriority(b))},g=function(a){var b,c=document.implementation.createHTMLDocument(""),d=document.createElement("style");return d.textContent=a,c.body.appendChild(d),b=d.sheet.cssRules,Array.prototype.slice.call(b)},h=function(){var a=g("a{background:url(i)}");return!a.length||a[0].cssText.indexOf("url()")>=0}();e.rulesForCssText=function(a){return h&&c.parse?c.parse(a).cssRules:g(a)};var i=function(a){return a.filter(function(a){return a.type===b.CSSRule.STYLE_RULE&&(a.style.getPropertyValue("background-image")||a.style.getPropertyValue("background"))})},j=function(a){var b=[];return a.forEach(function(a){a.style.getPropertyValue("background-image")?b.push({property:"background-image",value:a.style.getPropertyValue("background-image"),rule:a}):a.style.getPropertyValue("background")&&b.push({property:"background",value:a.style.getPropertyValue("background"),rule:a})}),b},k=function(a){return a.filter(function(a){return a.type===b.CSSRule.FONT_FACE_RULE&&a.style.getPropertyValue("src")})};e.cssRulesToText=function(a){return a.reduce(function(a,b){return a+b.cssText},"")};var l=function(a){var b=/^"(.*)"$/,c=/^'(.*)'$/;return b.test(a)?a.replace(b,"$1"):c.test(a)?a.replace(c,"$1"):a},m=function(a){var b=/^[\t\r\f\n ]*(.+?)[\t\r\f\n ]*$/;return a.replace(b,"$1")};e.extractCssUrl=function(a){var b,c=/^url\(([^\)]+)\)/;if(!c.test(a))throw new Error("Invalid url");return b=c.exec(a)[1],l(m(b))};var n=function(a){var b,c=/^format\(([^\)]+)\)/;return c.test(a)?(b=c.exec(a)[1],l(b)):null},o=function(a){var b,c=null;try{return b=e.extractCssUrl(a[0]),a[1]&&(c=n(a[1])),{url:b,format:c}}catch(d){}},p=function(a,b,c){var d="@font-face { font-family: "+b.style.getPropertyValue("font-family")+"; ";b.style.getPropertyValue("font-style")&&(d+="font-style: "+b.style.getPropertyValue("font-style")+"; "),b.style.getPropertyValue("font-weight")&&(d+="font-weight: "+b.style.getPropertyValue("font-weight")+"; "),d+="src: "+c+"}",q(a,b,d)},q=function(a,b,c){var d=a.indexOf(b),e=b.parentStyleSheet;e.insertRule(c,d+1),e.deleteRule(d),a[d]=e.cssRules[d]};e.adjustPathsOfCssResources=function(b,c){var d=i(c),e=j(d),g=!1;return e.forEach(function(c){var d,e=y(c.value),h=z(e);h.length>0&&(h.forEach(function(c){var d=e[c].url,f=a.joinUrl(b,d);e[c].url=f}),d=A(e),f(c.rule,c.property,d),g=!0)}),k(c).forEach(function(d){var e=d.style.getPropertyValue("src"),f=E(e),h=F(f);h.length>0&&(h.forEach(function(c){var d=f[c].url,e=a.joinUrl(b,d);f[c].url=e}),p(c,d,G(f)),g=!0)}),r(c).forEach(function(d){var e=d.href,f=a.joinUrl(b,e);q(c,d,"@import url("+f+");"),g=!0}),g};var r=function(a){return a.filter(function(a){return a.type===b.CSSRule.IMPORT_RULE&&a.href})},s=function(a,b,c){var d=a.indexOf(b);a.splice(d,1),c.forEach(function(b,c){a.splice(d+c,0,b)})},t=function(a){var b=/^"(.*)"$/,c=/^'(.*)'$/;return b.test(a)||c.test(a)},u=function(a){var b=d.defer();return b.resolve(a),b.promise},v=function(b,c,d,f){var g,h=c.href;return t(h)&&(h=l(h)),g=a.joinUrl(f.baseUrl,h),d.indexOf(g)>=0?(s(b,c,[]),u([])):(d.push(g),a.ajax(h,f).then(function(a){var g=e.rulesForCssText(a);return e.loadCSSImportsForRules(g,d,f).then(function(a){return e.adjustPathsOfCssResources(h,g),s(b,c,g),a.errors})},function(a){throw{resourceType:"stylesheet",url:a.url,msg:"Unable to load stylesheet "+a.url}}))};e.loadCSSImportsForRules=function(b,c,d){var e=r(b),f=[],g=!1;return a.all(e.map(function(a){return v(b,a,c,d).then(function(a){f=f.concat(a),g=!0},function(a){f.push(a)})})).then(function(){return{hasChanges:g,errors:f}})};var w=function(a){var b,c="\\s*(?:\"[^\"]*\"|'[^']*'|[^\\(]+)\\s*",d="(url\\("+c+"\\)|[^,\\s]+)",e="(?:\\s*"+d+")+",f="^\\s*("+e+")(?:\\s*,\\s*("+e+"))*\\s*$",g=new RegExp(e,"g"),h=[],i=function(a){var b,c=new RegExp(d,"g"),e=[];for(b=c.exec(a);b;)e.push(b[1]),b=c.exec(a);return e};if(a.match(new RegExp(f))){for(b=g.exec(a);b;)h.push(i(b[0])),b=g.exec(a);return h}return[]},x=function(a){var b,c;for(b=0;b<a.length;b++)try{return c=e.extractCssUrl(a[b]),{url:c,idx:b}}catch(d){}},y=function(a){var b=w(a);return b.map(function(a){var b=x(a);return b?{preUrl:a.slice(0,b.idx),url:b.url,postUrl:a.slice(b.idx+1)}:{preUrl:a}})},z=function(b){var c=[];return b.forEach(function(b,d){b.url&&!a.isDataUri(b.url)&&c.push(d)}),c},A=function(a){var b=a.map(function(a){var b=[].concat(a.preUrl);return a.url&&b.push('url("'+a.url+'")'),a.postUrl&&(b=b.concat(a.postUrl)),b.join(" ")});return b.join(", ")},B=function(b,c){var d=y(b),e=z(d),f=!1;return a.collectAndReportErrors(e.map(function(b){var e=d[b].url;return a.getDataURIForImageURL(e,c).then(function(a){d[b].url=a,f=!0},function(a){throw{resourceType:"backgroundImage",url:a.url,msg:"Unable to load background-image "+a.url}})})).then(function(a){return{backgroundValue:A(d),hasChanges:f,errors:a}})},C=function(b,c){var d=i(b),e=j(d),g=[],h=!1;return a.all(e.map(function(a){return B(a.value,c).then(function(b){b.hasChanges&&(f(a.rule,a.property,b.backgroundValue),h=!0),g=g.concat(b.errors)})})).then(function(){return{hasChanges:h,errors:g}})},D=function(a){var b,c="\\s*(?:\"[^\"]*\"|'[^']*'|[^\\(]+)\\s*",d="(local\\("+c+"\\))|(url\\("+c+"\\))(?:\\s+(format\\("+c+"\\)))?",e="^\\s*("+d+")(?:\\s*,\\s*("+d+"))*\\s*$",f=new RegExp(d,"g"),g=[],h=function(a){var b=[];return a.slice(1).forEach(function(a){a&&b.push(a)}),b};if(a.match(new RegExp(e))){for(b=f.exec(a);b;)g.push(h(b)),b=f.exec(a);return g}return[]},E=function(a){var b=D(a);return b.map(function(a){var b=o(a);return b?b:{local:a}})},F=function(b){var c=[];return b.forEach(function(b,d){b.url&&!a.isDataUri(b.url)&&c.push(d)}),c},G=function(a){return a.map(function(a){var b;return a.url?(b='url("'+a.url+'")',a.format&&(b+=' format("'+a.format+'")')):b=a.local,b}).join(", ")},H=function(b,c){var d=E(b),e=F(d),f=!1;return a.collectAndReportErrors(e.map(function(b){var e=d[b],g=e.format||"woff";return a.binaryAjax(e.url,c).then(function(a){var b=btoa(a);e.url="data:font/"+g+";base64,"+b,f=!0},function(a){throw{resourceType:"fontFace",url:a.url,msg:"Unable to load font-face "+a.url}})})).then(function(a){return{srcDeclarationValue:G(d),hasChanges:f,errors:a}})},I=function(b,c){var d=k(b),e=[],f=!1;return a.all(d.map(function(a){var d=a.style.getPropertyValue("src");return H(d,c).then(function(c){c.hasChanges&&(p(b,a,c.srcDeclarationValue),f=!0),e=e.concat(c.errors)})})).then(function(){return{hasChanges:f,errors:e}})};return e.loadAndInlineCSSResourcesForRules=function(b,c){var d=!1,e=[];return a.all([C,I].map(function(a){return a(b,c).then(function(a){d=d||a.hasChanges,e=e.concat(a.errors)})})).then(function(){return{hasChanges:d,errors:e}})},e}(e,window,c||{},d),g=function(a,b){"use strict";var c={},d=function(a){return b.joinUrl(a,".")},e=function(a){var b=a.map(function(b,c){return c===a.length-1&&(b={baseUrl:d(b.baseUrl)}),JSON.stringify(b)});return b},f=function(a,c){return c.cache!==!1&&"none"!==c.cache&&c.cacheBucket?b.memoize(a,e,c.cacheBucket):a},g=function(a,c){var d=a.attributes.src?a.attributes.src.nodeValue:null,e=b.getDocumentBaseUrl(a.ownerDocument),f=b.clone(c);return!f.baseUrl&&e&&(f.baseUrl=e),b.getDataURIForImageURL(d,f).then(function(a){return a},function(a){throw{resourceType:"image",url:a.url,msg:"Unable to load image "+a.url}})},h=function(a){return a.filter(function(a){var c=a.attributes.src?a.attributes.src.nodeValue:null;return null!==c&&!b.isDataUri(c)})},i=function(a){return Array.prototype.filter.call(a,function(a){return"image"===a.type})},j=function(a){return Array.prototype.slice.call(a)};c.loadAndInlineImages=function(a,c){var d=j(a.getElementsByTagName("img")),e=i(a.getElementsByTagName("input")),f=h(d.concat(e));return b.collectAndReportErrors(f.map(function(a){return g(a,c).then(function(b){a.attributes.src.nodeValue=b})}))};var k=function(b,c,d){var e=a.rulesForCssText(b);return a.loadCSSImportsForRules(e,c,d).then(function(c){return a.loadAndInlineCSSResourcesForRules(e,d).then(function(d){var f=c.errors.concat(d.errors),g=c.hasChanges||d.hasChanges;return g&&(b=a.cssRulesToText(e)),{hasChanges:g,content:b,errors:f}})})},l=function(a,c,d){var e=a.textContent,g=f(k,c);return g(e,d,c).then(function(c){return c.hasChanges&&(a.childNodes[0].nodeValue=c.content),b.cloneArray(c.errors)})},m=function(a){var b=a.getElementsByTagName("style");return Array.prototype.filter.call(b,function(a){return!a.attributes.type||"text/css"===a.attributes.type.nodeValue})};c.loadAndInlineStyles=function(a,c){var d,e=m(a),f=[],g=[];return d=b.clone(c),d.baseUrl=d.baseUrl||b.getDocumentBaseUrl(a),b.all(e.map(function(a){return l(a,d,g).then(function(a){f=f.concat(a)})})).then(function(){return f})};var n=function(a,b){var c,d=a.parentNode;b=b.trim(),b&&(c=a.ownerDocument.createElement("style"),c.type="text/css",c.appendChild(a.ownerDocument.createTextNode(b)),d.insertBefore(c,a)),d.removeChild(a)},o=function(c,d){return b.ajax(c,d).then(function(b){var c=a.rulesForCssText(b);return{content:b,cssRules:c}}).then(function(b){var d=a.adjustPathsOfCssResources(c,b.cssRules);return{content:b.content,cssRules:b.cssRules,hasChanges:d}}).then(function(b){return a.loadCSSImportsForRules(b.cssRules,[],d).then(function(a){return{content:b.content,cssRules:b.cssRules,hasChanges:b.hasChanges||a.hasChanges,errors:a.errors}})}).then(function(b){return a.loadAndInlineCSSResourcesForRules(b.cssRules,d).then(function(a){return{content:b.content,cssRules:b.cssRules,hasChanges:b.hasChanges||a.hasChanges,errors:b.errors.concat(a.errors)}})}).then(function(b){var c=b.content;return b.hasChanges&&(c=a.cssRulesToText(b.cssRules)),{content:c,errors:b.errors}})},p=function(a,c){var d=a.attributes.href.nodeValue,e=b.getDocumentBaseUrl(a.ownerDocument),g=b.clone(c);!g.baseUrl&&e&&(g.baseUrl=e);var h=f(o,c);return h(d,g).then(function(a){return{content:a.content,errors:b.cloneArray(a.errors)}})},q=function(a){var b=a.getElementsByTagName("link");return Array.prototype.filter.call(b,function(a){return a.attributes.rel&&"stylesheet"===a.attributes.rel.nodeValue&&(!a.attributes.type||"text/css"===a.attributes.type.nodeValue)})};c.loadAndInlineCssLinks=function(a,c){var d=q(a),e=[];return b.all(d.map(function(a){return p(a,c).then(function(b){n(a,b.content+"\n"),e=e.concat(b.errors)},function(a){e.push({resourceType:"stylesheet",url:a.url,msg:"Unable to load stylesheet "+a.url})})})).then(function(){return e})};var r=function(a,c){var d=a.attributes.src.nodeValue,e=b.getDocumentBaseUrl(a.ownerDocument),f=b.clone(c);return!f.baseUrl&&e&&(f.baseUrl=e),b.ajax(d,f).fail(function(a){throw{resourceType:"script",url:a.url,msg:"Unable to load script "+a.url}})},s=function(a){return a.replace(/<\//g,"<\\/")},t=function(a,b){a.attributes.removeNamedItem("src"),a.textContent=s(b)},u=function(a){var b=a.getElementsByTagName("script");return Array.prototype.filter.call(b,function(a){return!!a.attributes.src})};return c.loadAndInlineScript=function(a,c){var d=u(a);return b.collectAndReportErrors(d.map(function(a){return r(a,c).then(function(b){t(a,b)})}))},c.inlineReferences=function(a,d){var e=[],f=[c.loadAndInlineImages,c.loadAndInlineStyles,c.loadAndInlineCssLinks];return d.inlineScripts!==!1&&f.push(c.loadAndInlineScript),b.all(f.map(function(b){return b(a,d).then(function(a){e=e.concat(a)})})).then(function(){return e})},c}(f,e),h=function(a,b,c){"use strict";var d={},e=[];d={},d.getConstantUniqueIdFor=function(a){return e.indexOf(a)<0&&e.push(a),e.indexOf(a)};var f=function(a){var b,c={};for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);return c},g=function(a){return"object"==typeof a&&null!==a},h=function(a){return g(a)&&Object.prototype.toString.apply(a).match(/\[object (Canvas|HTMLCanvasElement)\]/i)},i=function(a){return"function"==typeof a};d.parseOptionalParameters=function(a){var b={canvas:null,options:{},callback:null};return i(a[0])?b.callback=a[0]:null==a[0]||h(a[0])?(b.canvas=a[0]||null,i(a[1])?b.callback=a[1]:(b.options=f(a[1]),b.callback=a[2]||null)):(b.options=f(a[0]),b.callback=a[1]||null),b};var j=function(b,c){return function(){var d=new b,e=d.open;return d.open=function(){var b=Array.prototype.slice.call(arguments),d=b.shift(),f=b.shift(),g=a.joinUrl(c,f);return e.apply(this,[d,g].concat(b))},d}},k=function(a,b){var c=a.createElement(b);return c.style.visibility="hidden",c.style.width="0px",c.style.height="0px",c.style.position="absolute",c.style.top="-10000px",c.style.left="-10000px",a.getElementsByTagName("body")[0].appendChild(c),c};d.executeJavascript=function(a,d,e){var f=k(c.document,"iframe"),g=a.documentElement.outerHTML,h=[],i=b.defer(),l=function(){var a=f.contentDocument;c.document.getElementsByTagName("body")[0].removeChild(f),i.resolve({document:a,errors:h})};return f.onload=e>0?function(){setTimeout(l,e)}:l,f.contentDocument.open(),f.contentWindow.XMLHttpRequest=j(f.contentWindow.XMLHttpRequest,d),f.contentWindow.onerror=function(a){h.push({resourceType:"scriptExecution",msg:a})},f.contentDocument.write(g),f.contentDocument.close(),i.promise};var l=function(a,b,c){var d=a.createElement("iframe");return d.style.width=b+"px",d.style.height=c+"px",d.style.visibility="hidden",d.style.position="absolute",d.style.top=-1e4-c+"px",d.style.left=-1e4-b+"px",d.sandbox="allow-same-origin",a.getElementsByTagName("body")[0].appendChild(d),d};d.calculateDocumentContentSize=function(a,d,e){var f=a.documentElement.outerHTML,g=l(c.document,d,e),h=b.defer();return g.onload=function(){var a=g.contentDocument,b=Math.max(a.documentElement.scrollWidth,a.body.clientWidth),d=Math.max(a.documentElement.scrollHeight,a.body.scrollHeight,a.body.clientHeight);c.document.getElementsByTagName("body")[0].removeChild(g),h.resolve({width:b,height:d})},g.contentDocument.open(),g.contentDocument.write(f),g.contentDocument.close(),h.promise};var m=function(a,b){var d,e,f,g,h=/<html((?:\s+[^>]*)?)>/im.exec(b),i=c.document.implementation.createHTMLDocument("");if(h)for(d="<div"+h[1]+"></div>",i.documentElement.innerHTML=d,f=i.querySelector("div"),e=0;e<f.attributes.length;e++)g=f.attributes[e],a.documentElement.setAttribute(g.name,g.value)};d.parseHTML=function(a){var b;return(new DOMParser).parseFromString("<a></a>","text/html")?b=(new DOMParser).parseFromString(a,"text/html"):(b=c.document.implementation.createHTMLDocument(""),b.documentElement.innerHTML=a,m(b,a)),b};var n=function(a){var b=new DOMParser,c=b.parseFromString("<","text/xml"),d=c.getElementsByTagName("parsererror")[0].namespaceURI;return"http://www.w3.org/1999/xhtml"===d?a.getElementsByTagName("parsererror").length>0:a.getElementsByTagNameNS(d,"parsererror").length>0},o=function(a){if(n(a))throw{message:"Invalid source"}};d.validateXHTML=function(a){var b=new DOMParser,c=b.parseFromString(a,"application/xml");o(c)};var p=null,q=function(a,b){return b===!1||"none"===b||"repeated"===b?((null===p||"repeated"!==b)&&(p=Date.now()),a+"?_="+p):a},r=function(c,d){var e=new window.XMLHttpRequest,f=a.joinUrl(d.baseUrl,c),g=q(f,d.cache),h=b.defer(),i=function(){h.reject({message:"Unable to load page"})};e.addEventListener("load",function(){200===e.status||0===e.status?h.resolve(e.responseXML):i()},!1),e.addEventListener("error",function(){i()},!1);try{e.open("GET",g,!0),e.responseType="document",e.send(null)}catch(j){i()}return h.promise};d.loadDocument=function(a,b){return r(a,b).then(function(a){return o(a),a})},d.addClassNameRecursively=function(a,b){a.className+=" "+b,a.parentNode!==a.ownerDocument&&d.addClassNameRecursively(a.parentNode,b)};var s=function(a,b){var c=a.parentStyleSheet,d=Array.prototype.indexOf.call(c.cssRules,a);c.insertRule(b,d+1),c.deleteRule(d)},t=function(a,b){var c=a.cssText.replace(/^[^\{]+/,""),d=b+" "+c;s(a,d)},u=function(a){return Array.prototype.reduce.call(a,function(a,b){return a+b.cssText},"")},v=function(a){a.textContent=u(a.sheet.cssRules)};return d.rewriteStyleRuleSelector=function(a,b,c){var d=b+"(?=\\W|$)";Array.prototype.forEach.call(a.querySelectorAll("style"),function(a){var b=Array.prototype.filter.call(a.sheet.cssRules,function(a){return a.selectorText&&new RegExp(d).test(a.selectorText)});b.length&&(b.forEach(function(a){var b=a.selectorText.replace(new RegExp(d,"g"),c);t(a,b)}),v(a))})},d.fakeHover=function(a,b){var c=a.querySelector(b),e="rasterizehtmlhover";c&&(d.addClassNameRecursively(c,e),d.rewriteStyleRuleSelector(a,":hover","."+e))},d.fakeActive=function(a,b){var c=a.querySelector(b),e="rasterizehtmlactive";c&&(d.addClassNameRecursively(c,e),d.rewriteStyleRuleSelector(a,":active","."+e))},d.persistInputValues=function(a){var b=Array.prototype.slice.call(a.querySelectorAll("input")),c=Array.prototype.slice.call(a.querySelectorAll("textarea")),d=function(a){return"checkbox"===a.type||"radio"===a.type};b.filter(d).forEach(function(a){a.checked?a.setAttribute("checked",""):a.removeAttribute("checked")}),b.filter(function(a){return!d(a)}).forEach(function(a){a.setAttribute("value",a.value)}),c.forEach(function(a){a.textContent=a.value})},d}(e,d,window),i=function(a,b,c,d){"use strict";var e={},f=function(){if(d.navigator.userAgent.indexOf("WebKit")>=0&&d.navigator.userAgent.indexOf("Chrome")<0)return!1;if(d.BlobBuilder||d.MozBlobBuilder||d.WebKitBlobBuilder)return!0;if(d.Blob)try{return new d.Blob(["<b></b>"],{type:"text/xml"}),!0}catch(a){return!1}return!1},g=function(a){var b,c="image/svg+xml;charset=utf-8",e=d.BlobBuilder||d.MozBlobBuilder||d.WebKitBlobBuilder;return e?(b=new e,b.append(a),b.getBlob(c)):new d.Blob([a],{type:c})},h=function(a){var b=d.URL||d.webkitURL||d;return f()?b.createObjectURL(g(a)):"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(a)},i=function(a){var b=d.URL||d.webkitURL||d;f()&&b.revokeObjectURL(a)},j=function(a,b){var c=a.createElement(b);return c.style.visibility="hidden",c.style.width="0px",c.style.height="0px",c.style.position="absolute",c.style.top="-10000px",c.style.left="-10000px",a.getElementsByTagName("body")[0].appendChild(c),c},k=function(a,b){var c=a.getElementById(b);return c||(c=j(a,"div"),c.id=b),c},l="rasterizeHTML_js_FirefoxWorkaround",m=function(){var a=d.navigator.userAgent.match(/Firefox\/(\d+).0/);return!a||!a[1]||parseInt(a[1],10)<17},n=function(b,c){var e,f=a.getConstantUniqueIdFor(b),g=c?c.ownerDocument:d.document;m()&&(e=k(g,l+f),e.innerHTML=b,e.className=l)},o=function(a){d.navigator.userAgent.indexOf("WebKit")>=0&&Array.prototype.forEach.call(a.getElementsByTagName("style"),function(a){a.textContent="span {}\n"+a.textContent})},p=function(b,c){var e=a.getConstantUniqueIdFor(b),f=c?c.ownerDocument:d.document,g=f.getElementById(l+e);g&&g.parentNode.removeChild(g)};e.getSvgForDocument=function(c,d,e){var f;return o(c),f=b.serializeToString(c),a.validateXHTML(f),'<svg xmlns="http://www.w3.org/2000/svg" width="'+d+'" height="'+e+'"><foreignObject width="100%" height="100%">'+f+"</foreignObject></svg>"};var q=function(){return{message:"Error rendering page"}};e.renderSvg=function(a,b){var e,f,g=c.defer(),j=function(){f.onload=null,f.onerror=null},k=function(){e&&i(e),p(a,b)};return n(a,b),e=h(a),f=new d.Image,f.onload=function(){j(),k(),g.resolve(f)},f.onerror=function(){k(),g.reject(q())},f.src=e,g.promise},e.drawImageOnCanvas=function(a,b){try{b.getContext("2d").drawImage(a,0,0)}catch(c){throw q()}};var r=function(a,b){var c=300,d=200,e=a?a.width:c,f=a?a.height:d,g=void 0!==b.width?b.width:e,h=void 0!==b.height?b.height:f;return{width:g,height:h}};return e.drawDocumentImage=function(b,c,d){var f=r(c,d);return d.hover&&a.fakeHover(b,d.hover),d.active&&a.fakeActive(b,d.active),a.calculateDocumentContentSize(b,f.width,f.height).then(function(a){return e.getSvgForDocument(b,a.width,a.height)}).then(function(a){return e.renderSvg(a,c)})},e}(h,b,d,window),j=function(a,b,c,d){"use strict";var e={},f=function(a,c,d){return b.drawDocumentImage(a,c,d).then(function(a){return c&&b.drawImageOnCanvas(a,c),a})},g=function(b,e,g){var h,i=g.executeJsTimeout||0;return h=d.clone(g),h.inlineScripts=g.executeJs===!0,c.inlineReferences(b,h).then(function(c){return g.executeJs?a.executeJavascript(b,g.baseUrl,i).then(function(b){var d=b.document;return a.persistInputValues(d),{document:d,errors:c.concat(b.errors)}}):{document:b,errors:c}}).then(function(a){return f(a.document,e,g).then(function(b){return{image:b,errors:a.errors}})})};e.drawDocument=function(){var b=arguments[0],c=Array.prototype.slice.call(arguments,1),d=a.parseOptionalParameters(c),e=g(b,d.canvas,d.options);return d.callback&&e.then(function(a){d.callback(a.image,a.errors)},function(){d.callback(null,[{resourceType:"document",msg:"Error rendering page"}])}),e};var h=function(b,c,d,f){var g=a.parseHTML(b);return e.drawDocument(g,c,d,f)};e.drawHTML=function(){var b=arguments[0],c=Array.prototype.slice.call(arguments,1),d=a.parseOptionalParameters(c);return h(b,d.canvas,d.options,d.callback)};var i=function(b,c,d,f){var g=a.loadDocument(b,d).then(function(a){return e.drawDocument(a,c,d)});return f&&g.then(function(a){f(a.image,a.errors)},function(a){f(null,[{resourceType:"page",url:b,msg:a.message+" "+b}])}),g};return e.drawURL=function(){var b=arguments[0],c=Array.prototype.slice.call(arguments,1),d=a.parseOptionalParameters(c);return i(b,d.canvas,d.options,d.callback)},e}(h,i,g,e);return j})},{ayepromise:2,cssom:23,url:25,xmlserializer:26}],2:[function(b,c,d){!function(b,e){"function"==typeof a&&a.amd?a(e):"object"==typeof d?c.exports=e():b.ayepromise=e()}(this,function(){"use strict";var a={},b=function(){var a=!1;return function(b){return function(){a||(a=!0,b.apply(null,arguments))}}},c=function(a){var b=a&&a.then;return null!==a&&"object"==typeof a&&"function"==typeof b?b.bind(a):void 0},d=function(a,b,c){setTimeout(function(){var d;try{d=b(c)}catch(e){return a.reject(e),void 0}d===a.promise?a.reject(new TypeError("Cannot resolve promise with itself")):a.resolve(d)},1)},e=function(a,b,c){b&&b.call?d(a,b,c):a.resolve(c)},f=function(a,b,c){b&&b.call?d(a,b,c):a.reject(c)},g=function(b,c){var d=a.defer();return{promise:d.promise,callFulfilled:function(a){e(d,b,a)},callRejected:function(a){f(d,c,a)}}},h=0,i=1,j=2;return a.defer=function(){var a,d=h,e=[],f=function(b){d=i,a=b,e.forEach(function(b){b.callFulfilled(a)})},k=function(b){d=j,a=b,e.forEach(function(b){b.callRejected(a)})},l=function(b){d===i?b.callFulfilled(a):d===j&&b.callRejected(a)},m=function(a,b){var c=g(a,b);return e.push(c),l(c),c.promise},n=function(a){var c=b();try{a(c(o),c(k))}catch(d){c(k)(d)}},o=function(a){var b;try{b=c(a)}catch(d){return k(d),void 0}b?n(b):f(a)},p=b();return{resolve:p(o),reject:p(k),promise:{then:m,fail:function(a){return m(null,a)}}}},a})},{}],3:[function(b,c,d){(function(b){!function(e){function f(a){throw RangeError(I[a])}function g(a,b){for(var c=a.length;c--;)a[c]=b(a[c]);return a}function h(a,b){return g(a.split(H),b).join(".")}function i(a){for(var b,c,d=[],e=0,f=a.length;f>e;)b=a.charCodeAt(e++),b>=55296&&56319>=b&&f>e?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function j(a){return g(a,function(a){var b="";return a>65535&&(a-=65536,b+=L(a>>>10&1023|55296),a=56320|1023&a),b+=L(a)}).join("")}function k(a){return 10>a-48?a-22:26>a-65?a-65:26>a-97?a-97:x}function l(a,b){return a+22+75*(26>a)-((0!=b)<<5)}function m(a,b,c){var d=0;for(a=c?K(a/B):a>>1,a+=K(a/b);a>J*z>>1;d+=x)a=K(a/J);return K(d+(J+1)*a/(a+A))}function n(a){var b,c,d,e,g,h,i,l,n,o,p=[],q=a.length,r=0,s=D,t=C;for(c=a.lastIndexOf(E),0>c&&(c=0),d=0;c>d;++d)a.charCodeAt(d)>=128&&f("not-basic"),p.push(a.charCodeAt(d));for(e=c>0?c+1:0;q>e;){for(g=r,h=1,i=x;e>=q&&f("invalid-input"),l=k(a.charCodeAt(e++)),(l>=x||l>K((w-r)/h))&&f("overflow"),r+=l*h,n=t>=i?y:i>=t+z?z:i-t,!(n>l);i+=x)o=x-n,h>K(w/o)&&f("overflow"),h*=o;b=p.length+1,t=m(r-g,b,0==g),K(r/b)>w-s&&f("overflow"),s+=K(r/b),r%=b,p.splice(r++,0,s)}return j(p)}function o(a){var b,c,d,e,g,h,j,k,n,o,p,q,r,s,t,u=[];for(a=i(a),q=a.length,b=D,c=0,g=C,h=0;q>h;++h)p=a[h],128>p&&u.push(L(p));for(d=e=u.length,e&&u.push(E);q>d;){for(j=w,h=0;q>h;++h)p=a[h],p>=b&&j>p&&(j=p);for(r=d+1,j-b>K((w-c)/r)&&f("overflow"),c+=(j-b)*r,b=j,h=0;q>h;++h)if(p=a[h],b>p&&++c>w&&f("overflow"),p==b){for(k=c,n=x;o=g>=n?y:n>=g+z?z:n-g,!(o>k);n+=x)t=k-o,s=x-o,u.push(L(l(o+t%s,0))),k=K(t/s);u.push(L(l(k,0))),g=m(c,r,d==e),c=0,++d}++c,++b}return u.join("")}function p(a){return h(a,function(a){return F.test(a)?n(a.slice(4).toLowerCase()):a})}function q(a){return h(a,function(a){return G.test(a)?"xn--"+o(a):a})}var r="object"==typeof d&&d,s="object"==typeof c&&c&&c.exports==r&&c,t="object"==typeof b&&b;(t.global===t||t.window===t)&&(e=t);var u,v,w=2147483647,x=36,y=1,z=26,A=38,B=700,C=72,D=128,E="-",F=/^xn--/,G=/[^ -~]/,H=/\x2E|\u3002|\uFF0E|\uFF61/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},J=x-y,K=Math.floor,L=String.fromCharCode;if(u={version:"1.2.4",ucs2:{decode:i,encode:j},decode:n,encode:o,toASCII:q,toUnicode:p},"function"==typeof a&&"object"==typeof a.amd&&a.amd)a("punycode",function(){return u});else if(r&&!r.nodeType)if(s)s.exports=u;else for(v in u)u.hasOwnProperty(v)&&(r[v]=u[v]);else e.punycode=u}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(a,b){"use strict";function c(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.exports=function(a,b,e,f){b=b||"&",e=e||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;j>k;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(e);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),c(g,n)?d(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var d=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],5:[function(a,b){"use strict";function c(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}var d=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,g,h){return b=b||"&",g=g||"=",null===a&&(a=void 0),"object"==typeof a?c(f(a),function(c){var f=encodeURIComponent(d(c))+g;return e(a[c])?a[c].map(function(a){return f+encodeURIComponent(d(a))}).join(b):f+encodeURIComponent(d(a[c]))}).join(b):h?encodeURIComponent(d(h))+g+encodeURIComponent(d(a)):""};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},f=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],6:[function(a,b,c){"use strict";c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":4,"./encode":5}],7:[function(a,b,c){var d={CSSRule:a("./CSSRule").CSSRule,MatcherList:a("./MatcherList").MatcherList};d.CSSDocumentRule=function(){d.CSSRule.call(this),this.matcher=new d.MatcherList,this.cssRules=[]},d.CSSDocumentRule.prototype=new d.CSSRule,d.CSSDocumentRule.prototype.constructor=d.CSSDocumentRule,d.CSSDocumentRule.prototype.type=10,Object.defineProperty(d.CSSDocumentRule.prototype,"cssText",{get:function(){for(var a=[],b=0,c=this.cssRules.length;c>b;b++)a.push(this.cssRules[b].cssText);return"@-moz-document "+this.matcher.matcherText+" {"+a.join("")+"}"}}),c.CSSDocumentRule=d.CSSDocumentRule},{"./CSSRule":13,"./MatcherList":19}],8:[function(a,b,c){var d={CSSStyleDeclaration:a("./CSSStyleDeclaration").CSSStyleDeclaration,CSSRule:a("./CSSRule").CSSRule};d.CSSFontFaceRule=function(){d.CSSRule.call(this),this.style=new d.CSSStyleDeclaration,this.style.parentRule=this},d.CSSFontFaceRule.prototype=new d.CSSRule,d.CSSFontFaceRule.prototype.constructor=d.CSSFontFaceRule,d.CSSFontFaceRule.prototype.type=5,Object.defineProperty(d.CSSFontFaceRule.prototype,"cssText",{get:function(){return"@font-face {"+this.style.cssText+"}"}}),c.CSSFontFaceRule=d.CSSFontFaceRule},{"./CSSRule":13,"./CSSStyleDeclaration":14}],9:[function(a,b,c){var d={CSSRule:a("./CSSRule").CSSRule,CSSStyleSheet:a("./CSSStyleSheet").CSSStyleSheet,MediaList:a("./MediaList").MediaList};d.CSSImportRule=function(){d.CSSRule.call(this),this.href="",this.media=new d.MediaList,this.styleSheet=new d.CSSStyleSheet},d.CSSImportRule.prototype=new d.CSSRule,d.CSSImportRule.prototype.constructor=d.CSSImportRule,d.CSSImportRule.prototype.type=3,Object.defineProperty(d.CSSImportRule.prototype,"cssText",{get:function(){var a=this.media.mediaText;return"@import url("+this.href+")"+(a?" "+a:"")+";"},set:function(a){for(var b,c,d=0,e="",f="";c=a.charAt(d);d++)switch(c){case" ":case"	":case"\r":case"\n":case"\f":"after-import"===e?e="url":f+=c;break;case"@":e||a.indexOf("@import",d)!==d||(e="after-import",d+="import".length,f="");break;case"u":if("url"===e&&a.indexOf("url(",d)===d){if(b=a.indexOf(")",d+1),-1===b)throw d+': ")" not found';d+="url(".length;var g=a.slice(d,b);g[0]===g[g.length-1]&&('"'===g[0]||"'"===g[0])&&(g=g.slice(1,-1)),this.href=g,d=b,e="media"
}break;case'"':if("url"===e){if(b=a.indexOf('"',d+1),!b)throw d+": '\"' not found";this.href=a.slice(d+1,b),d=b,e="media"}break;case"'":if("url"===e){if(b=a.indexOf("'",d+1),!b)throw d+': "\'" not found';this.href=a.slice(d+1,b),d=b,e="media"}break;case";":"media"===e&&f&&(this.media.mediaText=f.trim());break;default:"media"===e&&(f+=c)}}}),c.CSSImportRule=d.CSSImportRule},{"./CSSRule":13,"./CSSStyleSheet":16,"./MediaList":20}],10:[function(a,b,c){var d={CSSRule:a("./CSSRule").CSSRule,CSSStyleDeclaration:a("./CSSStyleDeclaration").CSSStyleDeclaration};d.CSSKeyframeRule=function(){d.CSSRule.call(this),this.keyText="",this.style=new d.CSSStyleDeclaration,this.style.parentRule=this},d.CSSKeyframeRule.prototype=new d.CSSRule,d.CSSKeyframeRule.prototype.constructor=d.CSSKeyframeRule,d.CSSKeyframeRule.prototype.type=9,Object.defineProperty(d.CSSKeyframeRule.prototype,"cssText",{get:function(){return this.keyText+" {"+this.style.cssText+"} "}}),c.CSSKeyframeRule=d.CSSKeyframeRule},{"./CSSRule":13,"./CSSStyleDeclaration":14}],11:[function(a,b,c){var d={CSSRule:a("./CSSRule").CSSRule};d.CSSKeyframesRule=function(){d.CSSRule.call(this),this.name="",this.cssRules=[]},d.CSSKeyframesRule.prototype=new d.CSSRule,d.CSSKeyframesRule.prototype.constructor=d.CSSKeyframesRule,d.CSSKeyframesRule.prototype.type=8,Object.defineProperty(d.CSSKeyframesRule.prototype,"cssText",{get:function(){for(var a=[],b=0,c=this.cssRules.length;c>b;b++)a.push("  "+this.cssRules[b].cssText);return"@"+(this._vendorPrefix||"")+"keyframes "+this.name+" { \n"+a.join("\n")+"\n}"}}),c.CSSKeyframesRule=d.CSSKeyframesRule},{"./CSSRule":13}],12:[function(a,b,c){var d={CSSRule:a("./CSSRule").CSSRule,MediaList:a("./MediaList").MediaList};d.CSSMediaRule=function(){d.CSSRule.call(this),this.media=new d.MediaList,this.cssRules=[]},d.CSSMediaRule.prototype=new d.CSSRule,d.CSSMediaRule.prototype.constructor=d.CSSMediaRule,d.CSSMediaRule.prototype.type=4,Object.defineProperty(d.CSSMediaRule.prototype,"cssText",{get:function(){for(var a=[],b=0,c=this.cssRules.length;c>b;b++)a.push(this.cssRules[b].cssText);return"@media "+this.media.mediaText+" {"+a.join("")+"}"}}),c.CSSMediaRule=d.CSSMediaRule},{"./CSSRule":13,"./MediaList":20}],13:[function(a,b,c){var d={};d.CSSRule=function(){this.parentRule=null,this.parentStyleSheet=null},d.CSSRule.STYLE_RULE=1,d.CSSRule.IMPORT_RULE=3,d.CSSRule.MEDIA_RULE=4,d.CSSRule.FONT_FACE_RULE=5,d.CSSRule.PAGE_RULE=6,d.CSSRule.WEBKIT_KEYFRAMES_RULE=8,d.CSSRule.WEBKIT_KEYFRAME_RULE=9,d.CSSRule.prototype={constructor:d.CSSRule},c.CSSRule=d.CSSRule},{}],14:[function(a,b,c){var d={};d.CSSStyleDeclaration=function(){this.length=0,this.parentRule=null,this._importants={}},d.CSSStyleDeclaration.prototype={constructor:d.CSSStyleDeclaration,getPropertyValue:function(a){return this[a]||""},setProperty:function(a,b,c){if(this[a]){var d=Array.prototype.indexOf.call(this,a);0>d&&(this[this.length]=a,this.length++)}else this[this.length]=a,this.length++;this[a]=b,this._importants[a]=c},removeProperty:function(a){if(!(a in this))return"";var b=Array.prototype.indexOf.call(this,a);if(0>b)return"";var c=this[a];return this[a]="",Array.prototype.splice.call(this,b,1),c},getPropertyCSSValue:function(){},getPropertyPriority:function(a){return this._importants[a]||""},getPropertyShorthand:function(){},isPropertyImplicit:function(){},get cssText(){for(var a=[],b=0,c=this.length;c>b;++b){var d=this[b],e=this.getPropertyValue(d),f=this.getPropertyPriority(d);f&&(f=" !"+f),a[b]=d+": "+e+f+";"}return a.join(" ")},set cssText(a){var b,c;for(b=this.length;b--;)c=this[b],this[c]="";Array.prototype.splice.call(this,0,this.length),this._importants={};var e=d.parse("#bogus{"+a+"}").cssRules[0].style,f=e.length;for(b=0;f>b;++b)c=e[b],this.setProperty(e[b],e.getPropertyValue(c),e.getPropertyPriority(c))}},c.CSSStyleDeclaration=d.CSSStyleDeclaration,d.parse=a("./parse").parse},{"./parse":24}],15:[function(a,b,c){var d={CSSStyleDeclaration:a("./CSSStyleDeclaration").CSSStyleDeclaration,CSSRule:a("./CSSRule").CSSRule};d.CSSStyleRule=function(){d.CSSRule.call(this),this.selectorText="",this.style=new d.CSSStyleDeclaration,this.style.parentRule=this},d.CSSStyleRule.prototype=new d.CSSRule,d.CSSStyleRule.prototype.constructor=d.CSSStyleRule,d.CSSStyleRule.prototype.type=1,Object.defineProperty(d.CSSStyleRule.prototype,"cssText",{get:function(){var a;return a=this.selectorText?this.selectorText+" {"+this.style.cssText+"}":""},set:function(a){var b=d.CSSStyleRule.parse(a);this.style=b.style,this.selectorText=b.selectorText}}),d.CSSStyleRule.parse=function(a){for(var b,c,e,f=0,g="selector",h=f,i="",j={selector:!0,value:!0},k=new d.CSSStyleRule,l="";e=a.charAt(f);f++)switch(e){case" ":case"	":case"\r":case"\n":case"\f":if(j[g])switch(a.charAt(f-1)){case" ":case"	":case"\r":case"\n":case"\f":break;default:i+=" "}break;case'"':if(h=f+1,b=a.indexOf('"',h)+1,!b)throw'" is missing';i+=a.slice(f,b),f=b-1;break;case"'":if(h=f+1,b=a.indexOf("'",h)+1,!b)throw"' is missing";i+=a.slice(f,b),f=b-1;break;case"/":if("*"===a.charAt(f+1)){if(f+=2,b=a.indexOf("*/",f),-1===b)throw new SyntaxError("Missing */");f=b+1}else i+=e;break;case"{":"selector"===g&&(k.selectorText=i.trim(),i="",g="name");break;case":":"name"===g?(c=i.trim(),i="",g="value"):i+=e;break;case"!":"value"===g&&a.indexOf("!important",f)===f?(l="important",f+="important".length):i+=e;break;case";":"value"===g?(k.style.setProperty(c,i.trim(),l),l="",i="",g="name"):i+=e;break;case"}":if("value"===g)k.style.setProperty(c,i.trim(),l),l="",i="";else{if("name"===g)break;i+=e}g="selector";break;default:i+=e}return k},c.CSSStyleRule=d.CSSStyleRule},{"./CSSRule":13,"./CSSStyleDeclaration":14}],16:[function(a,b,c){var d={StyleSheet:a("./StyleSheet").StyleSheet,CSSStyleRule:a("./CSSStyleRule").CSSStyleRule};d.CSSStyleSheet=function(){d.StyleSheet.call(this),this.cssRules=[]},d.CSSStyleSheet.prototype=new d.StyleSheet,d.CSSStyleSheet.prototype.constructor=d.CSSStyleSheet,d.CSSStyleSheet.prototype.insertRule=function(a,b){if(0>b||b>this.cssRules.length)throw new RangeError("INDEX_SIZE_ERR");var c=d.parse(a).cssRules[0];return c.parentStyleSheet=this,this.cssRules.splice(b,0,c),b},d.CSSStyleSheet.prototype.deleteRule=function(a){if(0>a||a>=this.cssRules.length)throw new RangeError("INDEX_SIZE_ERR");this.cssRules.splice(a,1)},d.CSSStyleSheet.prototype.toString=function(){for(var a="",b=this.cssRules,c=0;c<b.length;c++)a+=b[c].cssText+"\n";return a},c.CSSStyleSheet=d.CSSStyleSheet,d.parse=a("./parse").parse},{"./CSSStyleRule":15,"./StyleSheet":21,"./parse":24}],17:[function(a,b,c){var d={};d.CSSValue=function(){},d.CSSValue.prototype={constructor:d.CSSValue,set cssText(a){var b=this._getConstructorName();throw new Exception('DOMException: property "cssText" of "'+b+'" is readonly!')},get cssText(){var a=this._getConstructorName();throw new Exception('getter "cssText" of "'+a+'" is not implemented!')},_getConstructorName:function(){var a=this.constructor.toString(),b=a.match(/function\s([^\(]+)/),c=b[1];return c}},c.CSSValue=d.CSSValue},{}],18:[function(a,b,c){var d={CSSValue:a("./CSSValue").CSSValue};d.CSSValueExpression=function(a,b){this._token=a,this._idx=b},d.CSSValueExpression.prototype=new d.CSSValue,d.CSSValueExpression.prototype.constructor=d.CSSValueExpression,d.CSSValueExpression.prototype.parse=function(){for(var a,b=this._token,c=this._idx,d="",e="",f="",g=[];;++c){if(d=b.charAt(c),""==d){f="css expression error: unfinished expression!";break}switch(d){case"(":g.push(d),e+=d;break;case")":g.pop(d),e+=d;break;case"/":(a=this._parseJSComment(b,c))?a.error?f="css expression error: unfinished comment in expression!":c=a.idx:(a=this._parseJSRexExp(b,c))?(c=a.idx,e+=a.text):e+=d;break;case"'":case'"':a=this._parseJSString(b,c,d),a?(c=a.idx,e+=a.text):e+=d;break;default:e+=d}if(f)break;if(0==g.length)break}var h;return h=f?{error:f}:{idx:c,expression:e}},d.CSSValueExpression.prototype._parseJSComment=function(a,b){var c,d=a.charAt(b+1);if("/"==d||"*"==d){var e,f,g=b;return"/"==d?f="\n":"*"==d&&(f="*/"),e=a.indexOf(f,g+1+1),-1!==e?(e=e+f.length-1,c=a.substring(b,e+1),{idx:e,text:c}):(error="css expression error: unfinished comment in expression!",{error:error})}return!1},d.CSSValueExpression.prototype._parseJSString=function(a,b,c){var d,e=this._findMatchedIdx(a,b,c);return-1===e?!1:(d=a.substring(b,e+c.length),{idx:e,text:d})},d.CSSValueExpression.prototype._parseJSRexExp=function(a,b){var c=a.substring(0,b).replace(/\s+$/,""),d=[/^$/,/\($/,/\[$/,/\!$/,/\+$/,/\-$/,/\*$/,/\/\s+/,/\%$/,/\=$/,/\>$/,/\<$/,/\&$/,/\|$/,/\^$/,/\~$/,/\?$/,/\,$/,/delete$/,/in$/,/instanceof$/,/new$/,/typeof$/,/void$/],e=d.some(function(a){return a.test(c)});if(e){var f="/";return this._parseJSString(a,b,f)}return!1},d.CSSValueExpression.prototype._findMatchedIdx=function(a,b,c){for(var d,e=b,f=-1;;){if(d=a.indexOf(c,e+1),-1===d){d=f;break}var g=a.substring(b+1,d),h=g.match(/\\+$/);if(!h||h[0]%2==0)break;e=d}var i=a.indexOf("\n",b+1);return d>i&&(d=f),d},c.CSSValueExpression=d.CSSValueExpression},{"./CSSValue":17}],19:[function(a,b,c){var d={};d.MatcherList=function(){this.length=0},d.MatcherList.prototype={constructor:d.MatcherList,get matcherText(){return Array.prototype.join.call(this,", ")},set matcherText(a){for(var b=a.split(","),c=this.length=b.length,d=0;c>d;d++)this[d]=b[d].trim()},appendMatcher:function(a){-1===Array.prototype.indexOf.call(this,a)&&(this[this.length]=a,this.length++)},deleteMatcher:function(a){var b=Array.prototype.indexOf.call(this,a);-1!==b&&Array.prototype.splice.call(this,b,1)}},c.MatcherList=d.MatcherList},{}],20:[function(a,b,c){var d={};d.MediaList=function(){this.length=0},d.MediaList.prototype={constructor:d.MediaList,get mediaText(){return Array.prototype.join.call(this,", ")},set mediaText(a){for(var b=a.split(","),c=this.length=b.length,d=0;c>d;d++)this[d]=b[d].trim()},appendMedium:function(a){-1===Array.prototype.indexOf.call(this,a)&&(this[this.length]=a,this.length++)},deleteMedium:function(a){var b=Array.prototype.indexOf.call(this,a);-1!==b&&Array.prototype.splice.call(this,b,1)}},c.MediaList=d.MediaList},{}],21:[function(a,b,c){var d={};d.StyleSheet=function(){this.parentStyleSheet=null},c.StyleSheet=d.StyleSheet},{}],22:[function(a,b,c){var d={CSSStyleSheet:a("./CSSStyleSheet").CSSStyleSheet,CSSStyleRule:a("./CSSStyleRule").CSSStyleRule,CSSMediaRule:a("./CSSMediaRule").CSSMediaRule,CSSStyleDeclaration:a("./CSSStyleDeclaration").CSSStyleDeclaration,CSSKeyframeRule:a("./CSSKeyframeRule").CSSKeyframeRule,CSSKeyframesRule:a("./CSSKeyframesRule").CSSKeyframesRule};d.clone=function e(a){var b=new d.CSSStyleSheet,c=a.cssRules;if(!c)return b;for(var f={1:d.CSSStyleRule,4:d.CSSMediaRule,8:d.CSSKeyframesRule,9:d.CSSKeyframeRule},g=0,h=c.length;h>g;g++){var i=c[g],j=b.cssRules[g]=new f[i.type],k=i.style;if(k){for(var l=j.style=new d.CSSStyleDeclaration,m=0,n=k.length;n>m;m++){var o=l[m]=k[m];l[o]=k[o],l._importants[o]=k.getPropertyPriority(o)}l.length=k.length}i.hasOwnProperty("keyText")&&(j.keyText=i.keyText),i.hasOwnProperty("selectorText")&&(j.selectorText=i.selectorText),i.hasOwnProperty("mediaText")&&(j.mediaText=i.mediaText),i.hasOwnProperty("cssRules")&&(j.cssRules=e(i).cssRules)}return b},c.clone=d.clone},{"./CSSKeyframeRule":10,"./CSSKeyframesRule":11,"./CSSMediaRule":12,"./CSSStyleDeclaration":14,"./CSSStyleRule":15,"./CSSStyleSheet":16}],23:[function(a,b,c){"use strict";c.CSSStyleDeclaration=a("./CSSStyleDeclaration").CSSStyleDeclaration,c.CSSRule=a("./CSSRule").CSSRule,c.CSSStyleRule=a("./CSSStyleRule").CSSStyleRule,c.MediaList=a("./MediaList").MediaList,c.CSSMediaRule=a("./CSSMediaRule").CSSMediaRule,c.CSSImportRule=a("./CSSImportRule").CSSImportRule,c.CSSFontFaceRule=a("./CSSFontFaceRule").CSSFontFaceRule,c.StyleSheet=a("./StyleSheet").StyleSheet,c.CSSStyleSheet=a("./CSSStyleSheet").CSSStyleSheet,c.CSSKeyframesRule=a("./CSSKeyframesRule").CSSKeyframesRule,c.CSSKeyframeRule=a("./CSSKeyframeRule").CSSKeyframeRule,c.MatcherList=a("./MatcherList").MatcherList,c.CSSDocumentRule=a("./CSSDocumentRule").CSSDocumentRule,c.CSSValue=a("./CSSValue").CSSValue,c.CSSValueExpression=a("./CSSValueExpression").CSSValueExpression,c.parse=a("./parse").parse,c.clone=a("./clone").clone},{"./CSSDocumentRule":7,"./CSSFontFaceRule":8,"./CSSImportRule":9,"./CSSKeyframeRule":10,"./CSSKeyframesRule":11,"./CSSMediaRule":12,"./CSSRule":13,"./CSSStyleDeclaration":14,"./CSSStyleRule":15,"./CSSStyleSheet":16,"./CSSValue":17,"./CSSValueExpression":18,"./MatcherList":19,"./MediaList":20,"./StyleSheet":21,"./clone":22,"./parse":24}],24:[function(a,b,c){var d={};d.parse=function(a){for(var b,c,e,f,g,h,i,j,k,l,m=0,n="before-selector",o="",p={selector:!0,value:!0,atRule:!0,"importRule-begin":!0,importRule:!0,atBlock:!0,"documentRule-begin":!0},q=new d.CSSStyleSheet,r=q,s="",t=/@(-(?:\w+-)+)?keyframes/g,u=function(b){var c=a.substring(0,m).split("\n"),d=c.length,e=c.pop().length+1,f=new Error(b+" (line "+d+", char "+e+")");throw f.line=d,f.char=e,f.styleSheet=q,f};l=a.charAt(m);m++)switch(l){case" ":case"	":case"\r":case"\n":case"\f":p[n]&&(o+=l);break;case'"':b=m+1;do b=a.indexOf('"',b)+1,b||u('Unmatched "');while("\\"===a[b-2]);switch(o+=a.slice(m,b),m=b-1,n){case"before-value":n="value";break;case"importRule-begin":n="importRule"}break;case"'":b=m+1;do b=a.indexOf("'",b)+1,b||u("Unmatched '");while("\\"===a[b-2]);switch(o+=a.slice(m,b),m=b-1,n){case"before-value":n="value";break;case"importRule-begin":n="importRule"}break;case"/":"*"===a.charAt(m+1)?(m+=2,b=a.indexOf("*/",m),-1===b?u("Missing */"):m=b+1):o+=l,"importRule-begin"===n&&(o+=" ",n="importRule");break;case"@":if(a.indexOf("@-moz-document",m)===m){n="documentRule-begin",k=new d.CSSDocumentRule,k.__starts=m,m+="-moz-document".length,o="";break}if(a.indexOf("@media",m)===m){n="atBlock",g=new d.CSSMediaRule,g.__starts=m,m+="media".length,o="";break}if(a.indexOf("@import",m)===m){n="importRule-begin",m+="import".length,o+="@import";break}if(a.indexOf("@font-face",m)===m){n="fontFaceRule-begin",m+="font-face".length,i=new d.CSSFontFaceRule,i.__starts=m,o="";break}t.lastIndex=m;var v=t.exec(a);if(v&&v.index===m){n="keyframesRule-begin",j=new d.CSSKeyframesRule,j.__starts=m,j._vendorPrefix=v[1],m+=v[0].length-1,o="";break}"selector"==n&&(n="atRule"),o+=l;break;case"{":"selector"===n||"atRule"===n?(f.selectorText=o.trim(),f.style.__starts=m,o="",n="before-name"):"atBlock"===n?(g.media.mediaText=o.trim(),r=c=g,g.parentStyleSheet=q,o="",n="before-selector"):"fontFaceRule-begin"===n?(c&&(i.parentRule=c),i.parentStyleSheet=q,f=i,o="",n="before-name"):"keyframesRule-begin"===n?(j.name=o.trim(),c&&(j.parentRule=c),j.parentStyleSheet=q,r=c=j,o="",n="keyframeRule-begin"):"keyframeRule-begin"===n?(f=new d.CSSKeyframeRule,f.keyText=o.trim(),f.__starts=m,o="",n="before-name"):"documentRule-begin"===n&&(k.matcher.matcherText=o.trim(),c&&(k.parentRule=c),r=c=k,k.parentStyleSheet=q,o="",n="before-selector");break;case":":"name"===n?(e=o.trim(),o="",n="before-value"):o+=l;break;case"(":if("value"===n)if("expression"==o.trim()){var w=new d.CSSValueExpression(a,m).parse();w.error?u(w.error):(o+=w.expression,m=w.idx)}else b=a.indexOf(")",m+1),-1===b&&u('Unmatched "("'),o+=a.slice(m,b+1),m=b;else o+=l;break;case"!":"value"===n&&a.indexOf("!important",m)===m?(s="important",m+="important".length):o+=l;break;case";":switch(n){case"value":f.style.setProperty(e,o.trim(),s),s="",o="",n="before-name";break;case"atRule":o="",n="before-selector";break;case"importRule":h=new d.CSSImportRule,h.parentStyleSheet=h.styleSheet.parentStyleSheet=q,h.cssText=o+l,q.cssRules.push(h),o="",n="before-selector";break;default:o+=l}break;case"}":switch(n){case"value":f.style.setProperty(e,o.trim(),s),s="";case"before-name":case"name":f.__ends=m+1,c&&(f.parentRule=c),f.parentStyleSheet=q,r.cssRules.push(f),o="",n=r.constructor===d.CSSKeyframesRule?"keyframeRule-begin":"before-selector";break;case"keyframeRule-begin":case"before-selector":case"selector":c||u("Unexpected }"),r.__ends=m+1,q.cssRules.push(r),r=q,c=null,o="",n="before-selector"}break;default:switch(n){case"before-selector":n="selector",f=new d.CSSStyleRule,f.__starts=m;break;case"before-name":n="name";break;case"before-value":n="value";break;case"importRule-begin":n="importRule"}o+=l}return q},c.parse=d.parse,d.CSSStyleSheet=a("./CSSStyleSheet").CSSStyleSheet,d.CSSStyleRule=a("./CSSStyleRule").CSSStyleRule,d.CSSImportRule=a("./CSSImportRule").CSSImportRule,d.CSSMediaRule=a("./CSSMediaRule").CSSMediaRule,d.CSSFontFaceRule=a("./CSSFontFaceRule").CSSFontFaceRule,d.CSSStyleDeclaration=a("./CSSStyleDeclaration").CSSStyleDeclaration,d.CSSKeyframeRule=a("./CSSKeyframeRule").CSSKeyframeRule,d.CSSKeyframesRule=a("./CSSKeyframesRule").CSSKeyframesRule,d.CSSValueExpression=a("./CSSValueExpression").CSSValueExpression,d.CSSDocumentRule=a("./CSSDocumentRule").CSSDocumentRule},{"./CSSDocumentRule":7,"./CSSFontFaceRule":8,"./CSSImportRule":9,"./CSSKeyframeRule":10,"./CSSKeyframesRule":11,"./CSSMediaRule":12,"./CSSStyleDeclaration":14,"./CSSStyleRule":15,"./CSSStyleSheet":16,"./CSSValueExpression":18}],25:[function(a,b,c){!function(){"use strict";function b(a,b,c){if(a&&"object"==typeof a&&a.href)return a;if("string"!=typeof a)throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var e={},f=a;f=f.trim();var j=i.exec(f);if(j){j=j[0];var k=j.toLowerCase();e.protocol=k,f=f.substr(j.length)}if(c||j||f.match(/^\/\/[^@\/]+@[^@\/]+/)){var l="//"===f.substr(0,2);!l||j&&t[j]||(f=f.substr(2),e.slashes=!0)}if(!t[j]&&(l||j&&!u[j])){var w=f.indexOf("@");if(-1!==w){for(var x=f.slice(0,w),y=!0,z=0,A=o.length;A>z;z++)if(-1!==x.indexOf(o[z])){y=!1;break}y&&(e.auth=decodeURIComponent(x),f=f.substr(w+1))}for(var B=-1,z=0,A=n.length;A>z;z++){var C=f.indexOf(n[z]);-1!==C&&(0>B||B>C)&&(B=C)}-1!==B?(e.host=f.substr(0,B),f=f.substr(B)):(e.host=f,f="");for(var D=g(e.host),E=Object.keys(D),z=0,A=E.length;A>z;z++){var F=E[z];e[F]=D[F]}e.hostname=e.hostname||"";var G="["===e.hostname[0]&&"]"===e.hostname[e.hostname.length-1];if(e.hostname.length>p)e.hostname="";else if(!G)for(var H=e.hostname.split(/\./),z=0,A=H.length;A>z;z++){var I=H[z];if(I&&!I.match(q)){for(var J="",K=0,L=I.length;L>K;K++)J+=I.charCodeAt(K)>127?"x":I[K];if(!J.match(q)){var M=H.slice(0,z),N=H.slice(z+1),O=I.match(r);O&&(M.push(O[1]),N.unshift(O[2])),N.length&&(f="/"+N.join(".")+f),e.hostname=M.join(".");break}}}if(e.hostname=e.hostname.toLowerCase(),!G){for(var P=e.hostname.split("."),Q=[],z=0;z<P.length;++z){var R=P[z];Q.push(R.match(/[^A-Za-z0-9_-]/)?"xn--"+h.encode(R):R)}e.hostname=Q.join(".")}e.host=(e.hostname||"")+(e.port?":"+e.port:""),e.href+=e.host,G&&(e.hostname=e.hostname.substr(1,e.hostname.length-2),"/"!==f[0]&&(f="/"+f))}if(!s[k])for(var z=0,A=m.length;A>z;z++){var S=m[z],T=encodeURIComponent(S);T===S&&(T=escape(S)),f=f.split(S).join(T)}var U=f.indexOf("#");-1!==U&&(e.hash=f.substr(U),f=f.slice(0,U));var V=f.indexOf("?");return-1!==V?(e.search=f.substr(V),e.query=f.substr(V+1),b&&(e.query=v.parse(e.query)),f=f.slice(0,V)):b&&(e.search="",e.query={}),f&&(e.pathname=f),u[j]&&e.hostname&&!e.pathname&&(e.pathname="/"),(e.pathname||e.search)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=d(e),e}function d(a){"string"==typeof a&&(a=b(a));var c=a.auth||"";c&&(c=encodeURIComponent(c),c=c.replace(/%3A/i,":"),c+="@");var d=a.protocol||"",e=a.pathname||"",f=a.hash||"",g=!1,h="";void 0!==a.host?g=c+a.host:void 0!==a.hostname&&(g=c+(-1===a.hostname.indexOf(":")?a.hostname:"["+a.hostname+"]"),a.port&&(g+=":"+a.port)),a.query&&"object"==typeof a.query&&Object.keys(a.query).length&&(h=v.stringify(a.query));var i=a.search||h&&"?"+h||"";return d&&":"!==d.substr(-1)&&(d+=":"),a.slashes||(!d||u[d])&&g!==!1?(g="//"+(g||""),e&&"/"!==e.charAt(0)&&(e="/"+e)):g||(g=""),f&&"#"!==f.charAt(0)&&(f="#"+f),i&&"?"!==i.charAt(0)&&(i="?"+i),d+g+e+i+f}function e(a,b){return d(f(a,b))}function f(a,c){if(!a)return c;if(a=b(d(a),!1,!0),c=b(d(c),!1,!0),a.hash=c.hash,""===c.href)return a.href=d(a),a;if(c.slashes&&!c.protocol)return c.protocol=a.protocol,u[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=d(c),c;if(c.protocol&&c.protocol!==a.protocol){if(!u[c.protocol])return c.href=d(c),c;if(a.protocol=c.protocol,!c.host&&!t[c.protocol]){for(var e=(c.pathname||"").split("/");e.length&&!(c.host=e.shift()););c.host||(c.host=""),c.hostname||(c.hostname=""),""!==e[0]&&e.unshift(""),e.length<2&&e.unshift(""),c.pathname=e.join("/")}return a.pathname=c.pathname,a.search=c.search,a.query=c.query,a.host=c.host||"",a.auth=c.auth,a.hostname=c.hostname||c.host,a.port=c.port,(void 0!==a.pathname||void 0!==a.search)&&(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.slashes=a.slashes||c.slashes,a.href=d(a),a}var f=a.pathname&&"/"===a.pathname.charAt(0),g=void 0!==c.host||c.pathname&&"/"===c.pathname.charAt(0),h=g||f||a.host&&c.pathname,i=h,j=a.pathname&&a.pathname.split("/")||[],e=c.pathname&&c.pathname.split("/")||[],k=a.protocol&&!u[a.protocol];if(k&&(delete a.hostname,delete a.port,a.host&&(""===j[0]?j[0]=a.host:j.unshift(a.host)),delete a.host,c.protocol&&(delete c.hostname,delete c.port,c.host&&(""===e[0]?e[0]=c.host:e.unshift(c.host)),delete c.host),h=h&&(""===e[0]||""===j[0])),g)a.host=c.host||""===c.host?c.host:a.host,a.hostname=c.hostname||""===c.hostname?c.hostname:a.hostname,a.search=c.search,a.query=c.query,j=e;else if(e.length)j||(j=[]),j.pop(),j=j.concat(e),a.search=c.search,a.query=c.query;else if("search"in c){if(k){a.hostname=a.host=j.shift();var l=a.host&&a.host.indexOf("@")>0?a.host.split("@"):!1;l&&(a.auth=l.shift(),a.host=a.hostname=l.shift())}return a.search=c.search,a.query=c.query,(void 0!==a.pathname||void 0!==a.search)&&(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.href=d(a),a}if(!j.length)return delete a.pathname,a.search?delete a.path:a.path="/"+a.search,a.href=d(a),a;for(var m=j.slice(-1)[0],n=(a.host||c.host)&&("."===m||".."===m)||""===m,o=0,p=j.length;p>=0;p--)m=j[p],"."==m?j.splice(p,1):".."===m?(j.splice(p,1),o++):o&&(j.splice(p,1),o--);if(!h&&!i)for(;o--;o)j.unshift("..");!h||""===j[0]||j[0]&&"/"===j[0].charAt(0)||j.unshift(""),n&&"/"!==j.join("/").substr(-1)&&j.push("");var q=""===j[0]||j[0]&&"/"===j[0].charAt(0);if(k){a.hostname=a.host=q?"":j.length?j.shift():"";var l=a.host&&a.host.indexOf("@")>0?a.host.split("@"):!1;l&&(a.auth=l.shift(),a.host=a.hostname=l.shift())}return h=h||a.host&&j.length,h&&!q&&j.unshift(""),a.pathname=j.join("/"),(void 0!==a.pathname||void 0!==a.search)&&(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.auth=c.auth||a.auth,a.slashes=a.slashes||c.slashes,a.href=d(a),a}function g(a){var b={},c=j.exec(a);return c&&(c=c[0],":"!==c&&(b.port=c.substr(1)),a=a.substr(0,a.length-c.length)),a&&(b.hostname=a),b}var h=a("punycode");c.parse=b,c.resolve=e,c.resolveObject=f,c.format=d;var i=/^([a-z0-9.+-]+:)/i,j=/:[0-9]*$/,k=["<",">",'"',"`"," ","\r","\n","	"],l=["{","}","|","\\","^","~","`"].concat(k),m=["'"].concat(k),n=["%","/","?",";","#"].concat(l).concat(m),o=["/","@","?","#"].concat(k),p=255,q=/^[a-zA-Z0-9][a-z0-9A-Z_-]{0,62}$/,r=/^([a-zA-Z0-9][a-z0-9A-Z_-]{0,62})(.*)$/,s={javascript:!0,"javascript:":!0},t={javascript:!0,"javascript:":!0},u={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=a("querystring")}()},{punycode:3,querystring:6}],26:[function(a,b,c){var d=function(a){return a.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F]/g,"")},e=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},f=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},g=function(a){var b=a.value;return" "+a.name+'="'+e(b)+'"'},h=function(a){var b=Array.prototype.map.call(a.attributes||a.attrs,function(a){return a.name}).indexOf("xmlns")>=0;return"html"!==a.tagName.toLowerCase()||b?"":' xmlns="'+a.namespaceURI+'"'},i=function(a){return Array.prototype.map.call(a.childNodes,function(a){return m(a)}).join("")},j=function(a){var b="<"+a.tagName.toLowerCase();return b+=h(a),Array.prototype.forEach.call(a.attributes||a.attrs,function(a){b+=g(a)}),a.childNodes.length>0?(b+=">",b+=i(a),b+="</"+a.tagName.toLowerCase()+">"):b+="/>",b},k=function(a){var b=a.nodeValue||a.value||"";return f(b)},l=function(a){return"<!--"+a.data.replace(/-/g,"&#45;")+"-->"},m=function(a){return"#document"===a.nodeName||"#document-fragment"===a.nodeName?i(a):a.tagName?j(a):"#text"===a.nodeName?k(a):"#comment"===a.nodeName?l(a):void 0};c.serializeToString=function(a){return d(m(a))}},{}]},{},[1])(1)});